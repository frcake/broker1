!function(){var e={},t=function(t){for(var n=e[t],i=n.deps,r=n.defn,o=i.length,a=new Array(o),c=0;c<o;++c)a[c]=l(i[c]);var d=r.apply(null,a);if(void 0===d)throw"module ["+t+"] returned undefined";n.instance=d},n=function(t,n,l){if("string"!=typeof t)throw"module id must be a string";if(void 0===n)throw"no dependencies for "+t;if(void 0===l)throw"no definition function for "+t;e[t]={deps:n,defn:l,instance:void 0}},l=function(n){var l=e[n];if(void 0===l)throw"module ["+n+"] was undefined";return void 0===l.instance&&t(n),l.instance},i=function(e,t){for(var n=e.length,i=new Array(n),r=0;r<n;++r)i.push(l(e[r]));t.apply(null,t)};({}).bolt={module:{api:{define:n,require:i,demand:l}}};var r=n;(function(e,t){r(e,[],function(){return t})})("7",tinymce.util.Tools.resolve),r("1",["7"],function(e){return e("tinymce.html.DomParser")}),r("2",["7"],function(e){return e("tinymce.html.Node")}),r("3",["7"],function(e){return e("tinymce.html.Serializer")}),r("4",["7"],function(e){return e("tinymce.PluginManager")}),r("5",["7"],function(e){return e("tinymce.util.Tools")}),r("6",["5"],function(e){return{protectHtml:function(t,n){return e.each(t,function(e){n=n.replace(e,function(e){return"<!--mce:protected "+escape(e)+"-->"})}),n},unprotectHtml:function(e){return e.replace(/<!--mce:protected ([\s\S]*?)-->/g,function(e,t){return unescape(t)})}}}),r("0",["1","2","3","4","5","6"],function(e,t,n,l,i,r){return l.add("fullpage",function(l){function o(){var e=a();l.windowManager.open({title:"Document properties",data:e,defaults:{type:"textbox",size:40},body:[{name:"title",label:"Title"},{name:"keywords",label:"Keywords"},{name:"description",label:"Description"},{name:"robots",label:"Robots"},{name:"author",label:"Author"},{name:"docencoding",label:"Encoding"}],onSubmit:function(t){c(i.extend(e,t.data))}})}function a(){function e(e,t){return e.attr(t)||""}var t,n,r=d(),o={};return o.fontface=l.getParam("fullpage_default_fontface",""),o.fontsize=l.getParam("fullpage_default_fontsize",""),t=r.firstChild,7==t.type&&(o.xml_pi=!0,(n=/encoding="([^"]+)"/.exec(t.value))&&(o.docencoding=n[1])),t=r.getAll("#doctype")[0],t&&(o.doctype="<!DOCTYPE"+t.value+">"),t=r.getAll("title")[0],t&&t.firstChild&&(o.title=t.firstChild.value),p(r.getAll("meta"),function(e){var t,n=e.attr("name"),l=e.attr("http-equiv");n?o[n.toLowerCase()]=e.attr("content"):"Content-Type"==l&&(t=/charset\s*=\s*(.*)\s*/gi.exec(e.attr("content")))&&(o.docencoding=t[1])}),t=r.getAll("html")[0],t&&(o.langcode=e(t,"lang")||e(t,"xml:lang")),o.stylesheets=[],i.each(r.getAll("link"),function(e){"stylesheet"==e.attr("rel")&&o.stylesheets.push(e.attr("href"))}),t=r.getAll("body")[0],t&&(o.langdir=e(t,"dir"),o.style=e(t,"style"),o.visited_color=e(t,"vlink"),o.link_color=e(t,"link"),o.active_color=e(t,"alink")),o}function c(e){function r(e,t,n){e.attr(t,n||void 0)}function o(e){c.firstChild?c.insert(e,c.firstChild):c.append(e)}var a,c,u,s,f,g=l.dom;a=d(),c=a.getAll("head")[0],c||(s=a.getAll("html")[0],c=new t("head",1),s.firstChild?s.insert(c,s.firstChild,!0):s.append(c)),s=a.firstChild,e.xml_pi?(f='version="1.0"',e.docencoding&&(f+=' encoding="'+e.docencoding+'"'),7!=s.type&&(s=new t("xml",7),a.insert(s,a.firstChild,!0)),s.value=f):s&&7==s.type&&s.remove(),s=a.getAll("#doctype")[0],e.doctype?(s||(s=new t("#doctype",10),e.xml_pi?a.insert(s,a.firstChild):o(s)),s.value=e.doctype.substring(9,e.doctype.length-1)):s&&s.remove(),s=null,p(a.getAll("meta"),function(e){"Content-Type"==e.attr("http-equiv")&&(s=e)}),e.docencoding?(s||(s=new t("meta",1),s.attr("http-equiv","Content-Type"),s.shortEnded=!0,o(s)),s.attr("content","text/html; charset="+e.docencoding)):s&&s.remove(),s=a.getAll("title")[0],e.title?(s?s.empty():(s=new t("title",1),o(s)),s.append(new t("#text",3)).value=e.title):s&&s.remove(),p("keywords,description,author,copyright,robots".split(","),function(n){var l,i,r=a.getAll("meta"),c=e[n];for(l=0;l<r.length;l++)if(i=r[l],i.attr("name")==n)return void(c?i.attr("content",c):i.remove());c&&(s=new t("meta",1),s.attr("name",n),s.attr("content",c),s.shortEnded=!0,o(s))});var h={};i.each(a.getAll("link"),function(e){"stylesheet"==e.attr("rel")&&(h[e.attr("href")]=e)}),i.each(e.stylesheets,function(e){h[e]||(s=new t("link",1),s.attr({rel:"stylesheet",text:"text/css",href:e}),s.shortEnded=!0,o(s)),delete h[e]}),i.each(h,function(e){e.remove()}),s=a.getAll("body")[0],s&&(r(s,"dir",e.langdir),r(s,"style",e.style),r(s,"vlink",e.visited_color),r(s,"link",e.link_color),r(s,"alink",e.active_color),g.setAttribs(l.getBody(),{style:e.style,dir:e.dir,vLink:e.visited_color,link:e.link_color,aLink:e.active_color})),s=a.getAll("html")[0],s&&(r(s,"lang",e.langcode),r(s,"xml:lang",e.langcode)),c.firstChild||c.remove(),u=new n({validate:!1,indent:!0,apply_source_formatting:!0,indent_before:"head,html,body,meta,title,script,link,style",indent_after:"head,html,body,meta,title,script,link,style"}).serialize(a),m=u.substring(0,u.indexOf("</body>"))}function d(){return new e({validate:!1,root_name:"#document"}).parse(m)}function u(e){function t(e){return e.replace(/<\/?[A-Z]+/g,function(e){return e.toLowerCase()})}var n,o,a,c,u,f="",h=l.dom;if(!(e.selection||(a=r.protectHtml(l.settings.protect,e.content),"raw"==e.format&&m||e.source_view&&l.getParam("fullpage_hide_in_source_view")))){0!==a.length||e.source_view||(a=i.trim(m)+"\n"+i.trim(a)+"\n"+i.trim(g)),a=a.replace(/<(\/?)BODY/gi,"<$1body"),n=a.indexOf("<body"),-1!=n?(n=a.indexOf(">",n),m=t(a.substring(0,n+1)),o=a.indexOf("</body",n),-1==o&&(o=a.length),e.content=i.trim(a.substring(n+1,o)),g=t(a.substring(o))):(m=s(),g="\n</body>\n</html>"),c=d(),p(c.getAll("style"),function(e){e.firstChild&&(f+=e.firstChild.value)}),u=c.getAll("body")[0],u&&h.setAttribs(l.getBody(),{style:u.attr("style")||"",dir:u.attr("dir")||"",vLink:u.attr("vlink")||"",link:u.attr("link")||"",aLink:u.attr("alink")||""}),h.remove("fullpage_styles");var y=l.getDoc().getElementsByTagName("head")[0];f&&(h.add(y,"style",{id:"fullpage_styles"},f),u=h.get("fullpage_styles"),u.styleSheet&&(u.styleSheet.cssText=f));var v={};i.each(y.getElementsByTagName("link"),function(e){"stylesheet"==e.rel&&e.getAttribute("data-mce-fullpage")&&(v[e.href]=e)}),i.each(c.getAll("link"),function(e){var t=e.attr("href");return!t||(v[t]||"stylesheet"!=e.attr("rel")||h.add(y,"link",{rel:"stylesheet",text:"text/css",href:t,"data-mce-fullpage":"1"}),void delete v[t])}),i.each(v,function(e){e.parentNode.removeChild(e)})}}function s(){var e,t="",n="";return l.getParam("fullpage_default_xml_pi")&&(t+='<?xml version="1.0" encoding="'+l.getParam("fullpage_default_encoding","ISO-8859-1")+'" ?>\n'),t+=l.getParam("fullpage_default_doctype","<!DOCTYPE html>"),t+="\n<html>\n<head>\n",(e=l.getParam("fullpage_default_title"))&&(t+="<title>"+e+"</title>\n"),(e=l.getParam("fullpage_default_encoding"))&&(t+='<meta http-equiv="Content-Type" content="text/html; charset='+e+'" />\n'),(e=l.getParam("fullpage_default_font_family"))&&(n+="font-family: "+e+";"),(e=l.getParam("fullpage_default_font_size"))&&(n+="font-size: "+e+";"),(e=l.getParam("fullpage_default_text_color"))&&(n+="color: "+e+";"),t+="</head>\n<body"+(n?' style="'+n+'"':"")+">\n"}function f(e){e.selection||e.source_view&&l.getParam("fullpage_hide_in_source_view")||(e.content=r.unprotectHtml(i.trim(m)+"\n"+i.trim(e.content)+"\n"+i.trim(g)))}var m,g,p=i.each;l.addCommand("mceFullPageProperties",o),l.addButton("fullpage",{title:"Document properties",cmd:"mceFullPageProperties"}),l.addMenuItem("fullpage",{text:"Document properties",cmd:"mceFullPageProperties",context:"file"}),l.on("BeforeSetContent",u),l.on("GetContent",f)}),function(){}}),l("0")()}();