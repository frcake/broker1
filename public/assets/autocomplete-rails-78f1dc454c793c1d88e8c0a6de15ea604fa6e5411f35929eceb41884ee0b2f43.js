!function(t){t.fn.railsAutocomplete=function(){var a=function(){this.railsAutoCompleter||(this.railsAutoCompleter=new t.railsAutocomplete(this))};return void 0!==t.fn.on?$(document).on("focus",this.selector,a):this.live("focus",a)},t.railsAutocomplete=function(t){_e=t,this.init(_e)},t.railsAutocomplete.fn=t.railsAutocomplete.prototype={railsAutocomplete:"0.0.1"},t.railsAutocomplete.fn.extend=t.railsAutocomplete.extend=t.extend,t.railsAutocomplete.fn.extend({init:function(a){function e(t){return t.split(a.delimiter)}function i(t){return e(t).pop().replace(/^\s+/,"")}a.delimiter=t(a).attr("data-delimiter")||null,t(a).autocomplete({source:function(e,r){t.getJSON(t(a).attr("data-autocomplete"),{term:i(e.term)},function(){0==arguments[0].length&&(arguments[0]=[],arguments[0][0]={id:"",label:"no existing match"}),t(arguments[0]).each(function(e,i){var r={};r[i.id]=i,t(a).data(r)}),r.apply(null,arguments)})},change:function(a,e){if(""!=t(t(this).attr("data-id-element")).val()){t(t(this).attr("data-id-element")).val(e.item?e.item.id:"");var i=t.parseJSON(t(this).attr("data-update-elements")),r=e.item?t(this).data(e.item.id.toString()):{};if(!i||""!=t(i.id).val())for(var n in i)t(i[n]).val(e.item?r[n]:"")}},search:function(){var t=i(this.value);if(t.length<2)return!1},focus:function(){return!1},select:function(i,r){var n=e(this.value);if(n.pop(),n.push(r.item.value),null!=a.delimiter)n.push(""),this.value=n.join(a.delimiter);else if(this.value=n.join(""),t(this).attr("data-id-element")&&t(t(this).attr("data-id-element")).val(r.item.id),t(this).attr("data-update-elements")){var s=t(this).data(r.item.id.toString()),l=t.parseJSON(t(this).attr("data-update-elements"));for(var o in l)t(l[o]).val(s[o])}var d=this.value;return t(this).bind("keyup.clearId",function(){t(this).val().trim()!=d.trim()&&(t(t(this).attr("data-id-element")).val(""),t(this).unbind("keyup.clearId"))}),t(a).trigger("railsAutocomplete.select",r),!1}})}}),t(document).ready(function(){t("input[data-autocomplete]").railsAutocomplete()})}(jQuery);